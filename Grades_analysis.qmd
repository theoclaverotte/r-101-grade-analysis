---
title: "Grades analysis"
author: "Th√©o Claverotte dit Laprima"
format: html
echo: false
message: false
warning: false
---

```{r}
library(dplyr)
library(tidyr)
library(ggplot2)
library(here)
library(vroom)
library(stringr)
here::i_am("r-101-grade-analysis.Rproj")
```

## Question 1

```{r}
grades<-vroom(here("grades.csv"))
grades |> summarise(anyNA(Exam))
is.na(c(1, 2, NA, 4, NA))
```

## Question 2

```{r}
data_exam<-grades %>%
  summarise(mean(Exam, na.rm = TRUE), min(Exam, na.rm = TRUE), max(Exam,na.rm = TRUE), median(Exam, na.rm = TRUE), n())
library(knitr)
knitr::kable(data_exam)
```

## Question 3

```{r}
NA_exam <- grades %>%
  filter(is.na(Exam)) %>%
  count(is.na(Exam)) 
print(NA_exam)
```

the number of students who have not pass the Exam is `r NA_exam`.

## Question 4

```{r}
grades_without_na<-grades %>%
  filter(!is.na(Exam))
print(grades_without_na)
  
ggplot(grades_without_na, aes(x = Exam)) + geom_histogram(binwidth = 0.7, fill="darkorange")

```

## Question 5

```{r}
student_by_grp <- grades %>% 
  group_by(Group) %>%
  summarise(n())
print(student_by_grp)
  
```

## Question 6

```{r}

ggplot(grades, aes(x = Group, fill= Group)) + geom_bar() 
```

## Question 7

```{r}
ggplot(grades_without_na, aes(x = Group, y = Exam, fill = Group)) + geom_boxplot()
```

## Question 8

```{r}
missed_exam <- grades %>%
  group_by(Group) %>%
  summarise(Missed_Exam = sum(is.na(Exam)))

missed_exam_2 <- table(grades$Group, is.na(grades$Exam))

missed_exam_2 <- as.data.frame(missed_exam)
colnames(missed_exam_2) <- c("Group", "Missed_Exam")

knitr::kable(missed_exam)

```

## Question 9

```{r}
ggplot(missed_exam, aes(x = Group, y = Missed_Exam)) +
  geom_col() 
```

## Question 10 
```{r}
df_long_format_grades <- grades %>%
  pivot_longer(
    cols = -c(Id, Group), names_to = "name", values_to = "value"
  )

df_long_format_grades
```

## Question 11
```{r}
missing_grades_by_student <- df_long_format_grades %>%
  group_by(Id) %>%
  summarise(missing_grades_by_student = sum(is.na(value)))

missing_grades_by_student
```

## Question 12
```{r}
ggplot(missing_grades_by_student, aes(x = missing_grades_by_student)) +
  geom_histogram(binwidth = 1, fill = "lightgreen", color = "black") +
  labs(title = "Distribution of Total Missing Grades per Student", x = "Number of Missing Grades", y = "Frequency")
```

## Question 13 

```{r}
missing_student <- df_long_format_grades %>%
  filter(name== "Exam") %>%
  group_by(Group) %>%
  summarise(missing_student = sum(is.na(value)))


knitr::kable(missing_student)

```

## Question 14
```{r}
online_exam_na <- df_long_format_grades %>%
  filter(str_starts(name, "Online_MCQ")) %>%
  group_by(Id) %>%
  summarise(online_exam_na = sum(is.na(value)))
online_exam_na
```

#Question 15
